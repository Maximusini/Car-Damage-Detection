# üöó Car Damage Detection Telegram Bot

## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–≠—Ç–æ Telegram-–±–æ—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π –Ω–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è—Ö. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é –∞–≤—Ç–æ–º–æ–±–∏–ª—è, –∞ –±–æ—Ç –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç—É –∂–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é —Å –æ—Ç–º–µ—á–µ–Ω–Ω—ã–º–∏ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏—è–º–∏ (–≤–º—è—Ç–∏–Ω—ã, —Ü–∞—Ä–∞–ø–∏–Ω—ã, —Ç—Ä–µ—â–∏–Ω—ã, —Ä–∞–∑–±–∏—Ç—ã–µ —Å—Ç–µ–∫–ª–∞, —Å–ª–æ–º–∞–Ω–Ω—ã–µ —Ñ–∞—Ä—ã, —Å–ø—É—â–µ–Ω–Ω—ã–µ —à–∏–Ω—ã) –∏ —Å–ø–∏—Å–æ–∫ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã—Ö –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π.


## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
- [–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏](#–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)
- [–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏](#—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏)
- [–î–∞—Ç–∞—Å–µ—Ç](#–¥–∞—Ç–∞—Å–µ—Ç)
- [–û–±—É—á–µ–Ω–∏–µ](#–æ–±—É—á–µ–Ω–∏–µ) 
- [–£—Å—Ç–∞–Ω–æ–≤–∫–∞](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞)
- [–î–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ Docker](#–¥–µ–ø–ª–æ–π-—á–µ—Ä–µ–∑-docker)
- [–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ](#–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ)

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–î–µ—Ç–µ–∫—Ü–∏—è 6 —Ç–∏–ø–æ–≤ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π:** –í–º—è—Ç–∏–Ω–∞ (Dent), –¶–∞—Ä–∞–ø–∏–Ω–∞ (Scratch), –¢—Ä–µ—â–∏–Ω–∞ (Crack), –†–∞–∑–±–∏—Ç–æ–µ —Å—Ç–µ–∫–ª–æ (Glass shatter), –°–ª–æ–º–∞–Ω–Ω–∞—è —Ñ–∞—Ä–∞ (Lamp broken), –°–ø—É—â–µ–Ω–Ω–∞—è —à–∏–Ω–∞ (Tire flat).
- **–í–∏–∑—É–∞–ª—å–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ:** –ù–∞–Ω–µ—Å–µ–Ω–∏–µ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏—Ö —Ä–∞–º–æ–∫ –∏ –º–µ—Ç–æ–∫ –Ω–∞ –∏—Å—Ö–æ–¥–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ.
- **NMS:** –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –±–æ–∫—Å–æ–≤ —Å –ø–æ–º–æ—â—å—é NMS –¥–ª—è —Ç–æ—á–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.
- **Telegram Bot Interface:** –£–¥–æ–±–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Telegram-–±–æ—Ç–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.
- **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–Ω—Ñ–µ—Ä–µ–Ω—Å:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `ONNX Runtime` –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–æ–¥–µ–ª–∏.
- **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è:** –ì–æ—Ç–æ–≤—ã–π `Dockerfile` –¥–ª—è –ª–µ–≥–∫–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏.


## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
- **Python 3.11**: –û—Å–Ω–æ–≤–Ω–æ–π —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è.
- **YOLO11**: –ú–æ–¥–µ–ª—å –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏ –æ–±—ä–µ–∫—Ç–æ–≤.
- **ONNX Runtime**: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å –º–æ–¥–µ–ª–∏.
- **OpenCV**: –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.
- **pyTelegramBotAPI**: –§—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è Telegram-–±–æ—Ç–∞.
- **Docker**: –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
- **Git LFS**: –•—Ä–∞–Ω–µ–Ω–∏–µ –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤ –º–æ–¥–µ–ª–∏.

## –î–∞—Ç–∞—Å–µ—Ç
–ú–æ–¥–µ–ª—å –æ–±—É—á–µ–Ω–∞ –Ω–∞ –¥–∞—Ç–∞—Å–µ—Ç–µ [CarDD](https://cardd-ustc.github.io), –∫–æ—Ç–æ—Ä—ã–π –≤–∫–ª—é—á–∞–µ—Ç:
- 4,000 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π —Å –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏—è–º–∏.
- 9,000 –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π –¥–ª—è —à–µ—Å—Ç–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π: Dent, Scratch, Crack, Glass shatter, Lamp broken, Tire flat.

## –û–±—É—á–µ–Ω–∏–µ
–î–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –º–æ–¥–µ–ª–∏ YOLO11m –∏ YOLO11l –∏–∑ —Å–µ–º–µ–π—Å—Ç–≤–∞ YOLO11. –û–±—É—á–µ–Ω–∏–µ –ø—Ä–æ–≤–æ–¥–∏–ª–æ—Å—å –Ω–∞ –¥–∞—Ç–∞—Å–µ—Ç–µ [CarDD](https://cardd-ustc.github.io) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Google Colab (—Å–º. [Jupyter Notebook](https://github.com/Maximusin/car-damage-detector/main/Car_Damage_Train.ipynb))

### –û—Å–Ω–æ–≤–Ω—ã–µ —ç—Ç–∞–ø—ã:
1. **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö**: –ê–Ω–Ω–æ—Ç–∞—Ü–∏–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ COCO –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ —Ñ–æ—Ä–º–∞—Ç YOLO —Å –ø–æ–º–æ—â—å—é `ultralytics.data.converter`.
2. **–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π**:
   - **YOLO11m**: 50 —ç–ø–æ—Ö, —Ä–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π 640x640, batch size 8.
   - **YOLO11l**: 40 —ç–ø–æ—Ö, —Ä–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π 640x640, batch size 16, —Å —É—Å–∏–ª–µ–Ω–Ω–æ–π –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–µ–π.
   - **YOLO11l (–≤—ã—Å–æ–∫–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ)**: 40 —ç–ø–æ—Ö, —Ä–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π 1024x1024.
3. **–≠–∫—Å–ø–æ—Ä—Ç**: –ú–æ–¥–µ–ª–∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ ONNX –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ —á–µ—Ä–µ–∑ 'ONNX Runtime'.
4. **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã**:
   - YOLO11m: mAP50: 0.726, mAP50:95 = 0.576.
   - YOLO11l (imgsz=640): mAP50: 0.772, mAP50:95 = 0.609.
   - YOLO11l (imgsz=1024): mAP50: 0.731, mAP50:95 = 0.539.


## –£—Å—Ç–∞–Ω–æ–≤–∫–∞
1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π** (—Å Git LFS –¥–ª—è –º–æ–¥–µ–ª–∏):
   ```
   git clone https://github.com/Maximusin/car-damage-detector.git
   cd car-damage-detector
   git lfs install
   git lfs pull
   ```
2. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**
   ```
   pip install -r requirements.txt
   ```
3. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç –ª–æ–∫–∞–ª—å–Ω–æ (–∑–∞–º–µ–Ω–∏—Ç–µ token –Ω–∞ —Ç–æ–∫–µ–Ω –≤–∞—à–µ–≥–æ Telegram-–±–æ—Ç–∞)**

   *–î–ª—è Linux/macOS:*
   ```
   export TOKEN='token'
   python main.py
   ```
   *–î–ª—è Windows (PowerShell):*
   ```
   $env:TOKEN='token'
   python main.py
   ```
## –î–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ Docker
1. **–°–æ–±–µ—Ä–∏—Ç–µ Docker-–æ–±—Ä–∞–∑**
   ```
   docker build -t car_damage_detector .
   ```
2. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (–∑–∞–º–µ–Ω–∏—Ç–µ token –Ω–∞ —Ç–æ–∫–µ–Ω –≤–∞—à–µ–≥–æ Telegram-–±–æ—Ç–∞)**
   ```
   docker run --name CarDD -d -e TOKEN='token' car_damage_detector
   ```
## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç, –æ—Ç–ø—Ä–∞–≤–∏–≤ –∫–æ–º–∞–Ω–¥—É /start.
2. –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é –∞–≤—Ç–æ–º–æ–±–∏–ª—è.
   ![–û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏](screenshots/sent_photo.png)
3. –ü–æ–ª—É—á–∏—Ç–µ –∞–Ω–Ω–æ—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–º–∏ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏—è–º–∏ –∏ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.
   ![alt text](screenshots/result_photo.png)
